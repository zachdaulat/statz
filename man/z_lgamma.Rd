% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/extendr-wrappers.R
\name{z_lgamma}
\alias{z_lgamma}
\title{Compute the natural logarithm of the gamma function, ln Γ(z).}
\usage{
z_lgamma(z)
}
\arguments{
\item{z}{A positive numeric value}
}
\value{
The natural logarithm of the gamma function at z
}
\description{
Uses a simplified adaptation of the Boost.Math C++ library's Lanczos
approximation (lanczos13m53 parameter set, N=13, G≈6.0247),
optimised for IEEE 754 double-precision (f64) arithmetic. The coefficients
are from the \code{lanczos_sum_expG_scaled} variant, which absorbs both the
√(2π) constant and the e^G scaling factor into the rational polynomial,
eliminating two sources of rounding error.
}
\details{
The Lanczos sum is evaluated as a ratio of two degree-12 polynomials
P(z)/Q(z) via Horner's method with fused multiply-add (FMA) instructions,
avoiding the catastrophic cancellation that can occur with the traditional
alternating-sign summation formulation.

Maximum approximation error: ~1.2 × 10⁻¹⁷ (near full f64 precision),
except for inputs infinitesimally close to 1 and 2.

Simplifications relative to the full Boost implementation:
\itemize{
\item Omits the special Taylor series handling for z near 1 and 2
(costs ~1-2 ULPs in those neighbourhoods, negligible for statistical use)
\item Omits the log(tgamma(z)) path for 3 ≤ z < 100
}
}
\section{Arguments}{
\itemize{
\item \code{z} - A positive real number (z > 0), or z < 0.5 (handled via reflection)
}
}

\section{Returns}{
The value of ln Γ(z) as an f64.
}

\section{References}{
\itemize{
\item Boost.Math library: \url{https://www.boost.org/doc/libs/latest/libs/math/doc/html/math_toolkit/lanczos.html}
\item Pugh, G.R. (2004). "An Analysis of the Lanczos Gamma Approximation."
PhD thesis, University of British Columbia.
\item Lanczos, C. (1964). "A Precision Approximation of the Gamma Function."
SIAM Journal on Numerical Analysis, 1(1), 86-96.
}
}

